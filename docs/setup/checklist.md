# ğŸš€ å®Œå…¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å–ã‚Šèª¿ã¹å®¤ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Œå…¨ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨é‹ç”¨é–‹å§‹ã®ãŸã‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã§ã™ã€‚

## ğŸ“‹ äº‹å‰æº–å‚™

### Google Cloud Platform
- [ ] **Google Cloud Projectä½œæˆæ¸ˆã¿**
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: `interrogation-room` (æ¨å¥¨)
  - èª²é‡‘ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®šæ¸ˆã¿
  - å¿…è¦ãªAPIãŒæœ‰åŠ¹åŒ–å¯èƒ½ãªçŠ¶æ…‹

- [ ] **gcloud CLIè¨­å®šæ¸ˆã¿**
  ```bash
  gcloud auth login
  gcloud config set project YOUR_PROJECT_ID
  gcloud auth application-default login
  ```

### Firebase Setup
- [ ] **Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ¸ˆã¿**
  - Google Cloudãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨é€£æºæ¸ˆã¿
  - Authenticationæ©Ÿèƒ½æœ‰åŠ¹åŒ–æ¸ˆã¿
  - Firestore Databaseä½œæˆæ¸ˆã¿
  - Google OAuthè¨­å®šæ¸ˆã¿

- [ ] **Firebase Consoleè¨­å®šç¢ºèª**
  - Project Settings â†’ General â†’ Web appsè¨­å®š
  - Service Accounts â†’ Admin SDKè¨­å®š
  - Authentication â†’ Sign-in method â†’ Googleæœ‰åŠ¹åŒ–

---

## ğŸ”§ ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£è¨­å®š

### 1. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- [ ] **å®Ÿè¡Œ**: `./infra/setup-service-account.sh`
- [ ] **ç¢ºèª**: ä»¥ä¸‹ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
  ```bash
  gcloud iam service-accounts list --filter="email:interrogation-app@*"
  ```
- [ ] **æ¨©é™ç¢ºèª**: Firebase Admin, Firestore, Vertex AI, Secret Manageræ¨©é™ä»˜ä¸æ¸ˆã¿

### 2. Firebaseè¨­å®šã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
- [ ] **å®Ÿè¡Œ**: `./infra/setup-secrets.sh`
- [ ] **å…¥åŠ›é …ç›®**:
  - Firebase API Key
  - Firebase Auth Domain
  - Firebase Project ID
  - Firebase Storage Bucket
  - Firebase Messaging Sender ID
  - Firebase App ID
  - Firebase Measurement ID (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
- [ ] **ç¢ºèª**: Secret Managerã«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆä½œæˆæ¸ˆã¿
  ```bash
  gcloud secrets list --filter="name:firebase-"
  ```

### 3. Firebase Admin SDKèªè¨¼
- [ ] **å®Ÿè¡Œ**: `./infra/setup-firebase-auth-secrets.sh`
- [ ] **é¸æŠã—ãŸèªè¨¼æ–¹å¼**:
  - [ ] ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: å®Œå…¨ãªã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆJSON
  - [ ] ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: å€‹åˆ¥èªè¨¼æƒ…å ±
  - [ ] ã‚ªãƒ—ã‚·ãƒ§ãƒ³3: Application Default Credentials
- [ ] **ç¢ºèª**: èªè¨¼è¨­å®šãŒSecret Managerã«ä¿å­˜æ¸ˆã¿

### 4. ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š
- [ ] **å®Ÿè¡Œ**: `./infra/setup-admin-users.sh`
- [ ] **ç®¡ç†è€…ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›æ¸ˆã¿**:
  - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹1: `____________________`
  - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹2: `____________________`
  - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹3: `____________________`
- [ ] **ç¢ºèª**: `admin-emails` ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆä½œæˆæ¸ˆã¿
  ```bash
  gcloud secrets describe admin-emails
  ```

### 5. Cloud Buildæ¨©é™è¨­å®š
- [ ] **å®Ÿè¡Œ**: `./infra/setup-cloudbuild-permissions.sh`
- [ ] **ç¢ºèª**: Cloud Buildã¨Compute SAã«Secret Manageræ¨©é™ä»˜ä¸æ¸ˆã¿
- [ ] **ç¢ºèª**: ã™ã¹ã¦ã®Firebaseã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™è¨­å®šæ¸ˆã¿

---

## ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤

### åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] **å®Ÿè¡Œ**: `gcloud builds submit --config=infra/cloudbuild-frontend.yml`
- [ ] **ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª**: Cloud Build ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ç¢ºèª
- [ ] **ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸç¢ºèª**: Cloud Runã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ç¢ºèª
- [ ] **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³URLå–å¾—**:
  ```bash
  gcloud run services describe interrogation-app --region=asia-northeast1 --format="value(status.url)"
  ```

### ç®¡ç†è€…æ¨©é™åˆæœŸåŒ–
- [ ] **å®Ÿè¡Œ**: `./init-admin.sh`
- [ ] **æˆåŠŸç¢ºèª**: ç®¡ç†è€…æ¨©é™ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚ŒãŸ
- [ ] **ãƒ­ã‚°ã‚¤ãƒ³ç¢ºèª**: ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚¢ãƒ—ãƒªã«ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½

---

## âœ… å‹•ä½œç¢ºèª

### åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- [ ] **ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼**:
  - [ ] `/login` ãƒšãƒ¼ã‚¸ã§Googleãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
  - [ ] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸è¡¨ç¤ºæˆåŠŸ
  - [ ] ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½æ­£å¸¸å‹•ä½œ

- [ ] **ãƒ¦ãƒ¼ã‚¶ãƒ¼æ©Ÿèƒ½**:
  - [ ] æ–°è¦ã‚±ãƒ¼ã‚¹ä½œæˆå¯èƒ½
  - [ ] ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½æ­£å¸¸å‹•ä½œ
  - [ ] ã‚±ãƒ¼ã‚¹ä¸€è¦§è¡¨ç¤ºæ­£å¸¸
  - [ ] ã‚±ãƒ¼ã‚¹å‰Šé™¤å¯èƒ½

### ç®¡ç†è€…æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- [ ] **ç®¡ç†è€…ã‚¢ã‚¯ã‚»ã‚¹**:
  - [ ] `/admin` ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹æˆåŠŸï¼ˆç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
  - [ ] `/admin` ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ï¼ˆä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

- [ ] **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç®¡ç†**:
  - [ ] æ–°è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä½œæˆæˆåŠŸ
  - [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç·¨é›†æˆåŠŸ
  - [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æœ‰åŠ¹/ç„¡åŠ¹åˆ‡ã‚Šæ›¿ãˆæˆåŠŸ
  - [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å‰Šé™¤æˆåŠŸ

- [ ] **ã‚µãƒãƒªãƒ¼ç®¡ç†**:
  - [ ] ã‚±ãƒ¼ã‚¹ä¸€è¦§è¡¨ç¤ºæˆåŠŸ
  - [ ] ã‚µãƒãƒªãƒ¼ç”ŸæˆæˆåŠŸ
  - [ ] ç”Ÿæˆã•ã‚ŒãŸã‚µãƒãƒªãƒ¼è¡¨ç¤ºæˆåŠŸ
  - [ ] ã‚µãƒãƒªãƒ¼æ¤œç´¢æ©Ÿèƒ½å‹•ä½œç¢ºèª

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèª

### æ¨©é™è¨­å®šç¢ºèª
- [ ] **Firebase Custom Claims**:
  ```bash
  # ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®custom claimsç¢ºèª
  # Firebase Admin SDKã‚’ä½¿ç”¨ã—ã¦ç¢ºèª
  ```

- [ ] **Secret Manageræ¨©é™**:
  - [ ] ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«é©åˆ‡ãªæ¨©é™ã®ã¿ä»˜ä¸
  - [ ] ä¸è¦ãªæ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ãªã„
  - [ ] IAMãƒãƒªã‚·ãƒ¼ã®æœ€å°æ¨©é™åŸå‰‡éµå®ˆ

- [ ] **API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¿è­·**:
  - [ ] `/api/admin/*` ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒç®¡ç†è€…ã®ã¿ã«åˆ¶é™
  - [ ] èªè¨¼ãªã—ã§ã®APIã‚¢ã‚¯ã‚»ã‚¹ãŒé©åˆ‡ã«æ‹’å¦
  - [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«ã‚¹ã‚³ãƒ¼ãƒ—ã•ã‚Œã¦ã„ã‚‹

### ãƒ‡ãƒ¼ã‚¿ä¿è­·ç¢ºèª
- [ ] **Firestore Rules**:
  - [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
  - [ ] ç®¡ç†è€…ã¯å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
  - [ ] èªè¨¼ãªã—ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦

- [ ] **Secretç®¡ç†**:
  - [ ] ã™ã¹ã¦ã®æ©Ÿå¯†æƒ…å ±ãŒSecret Managerã«ä¿å­˜
  - [ ] ç’°å¢ƒå¤‰æ•°ã‚„ã‚³ãƒ¼ãƒ‰ã«æ©Ÿå¯†æƒ…å ±ãªã—
  - [ ] ãƒ­ã‚°ã«æ©Ÿå¯†æƒ…å ±ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ãªã„
